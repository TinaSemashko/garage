"use strict";(self.webpackChunkconnectify=self.webpackChunkconnectify||[]).push([[557],{6557:function(e,n,t){t.r(n),t.d(n,{default:function(){return X}});var r,i,a,o,s,l,c,d,u,m,x=t(4165),p=t(5861),h=t(9439),g=t(7313),v=t(1413),f=t(5851),Z=function(){var e=(0,g.useState)(!1),n=(0,h.Z)(e,2),t=n[0],r=n[1],i=(0,g.useState)(null),a=(0,h.Z)(i,2),o=a[0],s=a[1],l=(0,g.useContext)(f.Z),c=l.authState,d=l.globalLogOutDispatch,u=(0,g.useCallback)(function(){var e=(0,p.Z)((0,x.Z)().mark((function e(n,t,i,a){var o,l,u;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),s(null),e.prev=2,c.isLoggedIn&&(t.headers["x-access-token"]=c.authToken),e.next=6,fetch("http://localhost:4000/api/"+n,(0,v.Z)({},t));case 6:if((o=e.sent).ok){e.next=12;break}return e.next=10,o.json();case 10:throw l=e.sent,new Error(l.error);case 12:return e.next=14,o.json();case 14:if(u=e.sent,e.t0=i,!e.t0){e.next=19;break}return e.next=19,i(u);case 19:e.next=25;break;case 21:e.prev=21,e.t1=e.catch(2),e.t1&&e.t1.message&&"Unauthorized"===e.t1.message&&d(),a?a(e.t1.message||e.t1.error||e.t1):s(e.t1.message||e.t1.error||e.t1);case 25:r(!1);case 26:case"end":return e.stop()}}),e,null,[[2,21]])})));return function(n,t,r,i){return e.apply(this,arguments)}}(),[c.isLoggedIn,c.authToken,d]);return{loading:t,error:o,request:u,setError:s}},j=t(8467),y=t(2284),b=t(5664),w=t(1113),k=t(1550),S=t(7482),C=t(1727),A=t(7131),W=t(7406),E=t(1210),I=t(8530),P=t(555),T=t(168),q=t(1095),z=t(8564),R=(0,z.ZP)("div")(r||(r=(0,T.Z)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  overflow: hidden;\n  background-color: ",";\n  text-align: center;\n  margin-left: 30%;\n  margin-right: 30%;\n  border-radius: 10px;\n  margin-bottom: 5%;\n\n  @media (max-width: 750px) {\n    display: grid;\n    grid-template-columns: 1fr;\n    margin-left: 0%;\n    margin-right: 0%;\n  }\n"])),(function(e){return e.theme.palette.secondary.main})),U=(0,z.ZP)("div")(i||(i=(0,T.Z)(["\n  padding-top: 4vh;\n  padding-bottom: 4vh;\n\n  .lien-inscr {\n    text-decoration: underline;\n  }\n"]))),D=(0,z.ZP)("div")(a||(a=(0,T.Z)(["\n  display: flex;\n  justify-content: center;\n"]))),M=(0,z.ZP)(q.Z)(o||(o=(0,T.Z)(["\n  background-color: ",";\n  color: ",";\n  border-radius: 10px;\n\n  @media (max-width: 750px) {\n  }\n"])),(function(e){return e.theme.palette.primary.main}),(function(e){return e.theme.palette.colorWhite.main})),V=t(6417),L=function(e){var n=(0,j.s0)(),t=e.onSubmit,r=(0,g.useState)({valid:!1,messages:[],display:!1}),i=(0,h.Z)(r,2),a=i[0],o=i[1],s=(0,g.useState)(!1),l=(0,h.Z)(s,2),c=l[0],d=l[1],u=a.valid;return(0,V.jsx)(R,{children:(0,V.jsx)(I.eU,{children:(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(y.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:{xs:"50vw",md:"25vw"},borderRadius:"10px",borderBlockColor:"colorWhite.main",backgroundColor:"colorWhite.main",boxShadow:" 0px 4px 4px gray inset"}},noValidate:!0,autoComplete:"off",onSubmit:function(e){u&&t(e)},children:(0,V.jsxs)(U,{children:[(0,V.jsx)(w.Z,{variant:"body1",color:"colorWhite.main",textAlign:"center",paddingLeft:"1.5rem",children:"Email :"}),(0,V.jsx)(I.Qq,{name:"email",regex:[/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/,"Votre email n'est pas valide"],after:function(e){return o(e)},children:(0,V.jsx)(D,{children:(0,V.jsx)(b.Z,{required:!0,id:"email",type:"text",placeholder:"Entrez votre email...",fullWidth:!0,name:"email"})})}),(0,V.jsx)(w.Z,{variant:"body1",color:"colorWhite.main",textAlign:"center",paddingLeft:"1.5rem",children:"Mot de passe :"}),(0,V.jsx)(k.Z,{sx:{m:1,width:{xs:"50vw",md:"25vw"},borderRadius:"10px",borderBlockColor:"colorWhite.main",backgroundColor:"colorWhite.main",boxShadow:" 0px 4px 4px gray inset"},variant:"standard",children:(0,V.jsx)(S.Z,{id:"filled-adornment-password",type:c?"text":"password",autoComplete:"new-password",placeholder:"Entrez votre mot de passe...",name:"password",endAdornment:(0,V.jsx)(C.Z,{position:"end",children:(0,V.jsx)(A.Z,{"aria-label":"toggle password visibility",onClick:function(){return d((function(e){return!e}))},onMouseDown:function(e){e.preventDefault()},edge:"end",children:c?(0,V.jsx)(W.Z,{}):(0,V.jsx)(E.Z,{})})})})}),(0,V.jsx)("br",{}),(0,V.jsx)("br",{}),(0,V.jsx)(M,{type:"submit",variant:"contained",color:"secondary",disabled:!u,children:"Se Connecter"}),(0,V.jsx)("br",{}),(0,V.jsx)("br",{}),(0,V.jsxs)(w.Z,{variant:"body1",sx:{color:"colorWhite.main"},children:["Pas de compte ?\xa0",(0,V.jsx)("span",{className:"lien-inscr",onClick:function(){return n(P.Z.auth)},style:{cursor:"pointer"},children:"Inscrivez-vous"})]})]})})})})})},N=t(7327),Q=t(6884),F=t(517),O=(0,z.ZP)("div")(s||(s=(0,T.Z)(["\n  text-align: center;\n\n  @media (max-width: 750px) {\n    align-items: center;\n  }\n"]))),_=(0,z.ZP)(q.Z)(l||(l=(0,T.Z)(["\n  background-color: ",";\n  color: ",";\n  border-radius: 10px;\n\n  @media (max-width: 750px) {\n  }\n"])),(function(e){return e.theme.palette.primary.main}),(function(e){return e.theme.palette.colorWhite.main})),B=(0,z.ZP)(y.Z)(c||(c=(0,T.Z)(["\n  display: flex;\n  justify-content: space-evenly;\n  text-align: center;\n  align-items: center;\n  padding-left: 20%;\n  padding-right: 20%;\n\n  @media (max-width: 750px) {\n    flex-direction: column;\n    padding-left: 0%;\n    padding-right: 0%;\n  }\n"]))),$=(0,z.ZP)(y.Z)(d||(d=(0,T.Z)(["\n  display: flex;\n  justify-content: space-evenly;\n  text-align: center;\n  align-items: center;\n  padding-left: 20%;\n  padding-right: 20%;\n\n  @media (max-width: 750px) {\n    display: none;\n  }\n"]))),H=(0,z.ZP)(y.Z)(u||(u=(0,T.Z)(["\n  display: none;\n\n  @media (max-width: 750px) {\n    display: flex;\n    justify-content: space-evenly;\n    text-align: center;\n    align-items: center;\n    flex-direction: column;\n    padding-left: 0%;\n    padding-right: 0%;\n  }\n"]))),J=function(e){var n=e.onSubmit,t=(0,g.useState)({valid:!1,messages:[],display:!1}),r=(0,h.Z)(t,2),i=r[0],a=r[1],o=(0,g.useState)({valid:!1,messages:[],display:!1}),s=(0,h.Z)(o,2),l=s[0],c=s[1],d=(0,g.useState)({valid:!1,messages:[],display:!1}),u=(0,h.Z)(d,2),m=u[0],v=u[1],Z=(0,g.useState)({valid:!1,messages:[],display:!1}),j=(0,h.Z)(Z,2),k=j[0],S=j[1],C=(0,g.useState)({valid:!1,messages:[],display:!1}),A=(0,h.Z)(C,2),W=A[0],E=A[1],P=(0,g.useState)(),T=(0,h.Z)(P,2),q=T[0],z=T[1],R=(0,g.useContext)(f.Z).authState.role,U=(0,g.useState)(Q.v.VISITEUR),D=(0,h.Z)(U,2),M=D[0],L=D[1],J=i.valid&&l.valid&&m.valid&&k.valid&&W.valid;console.log(J);return(0,g.useEffect)((function(){var e=function(){var e=(0,p.Z)((0,x.Z)().mark((function e(){return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.Z.get("roles").then((function(e){z(e.data.results[0])})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,V.jsx)(O,{children:(0,V.jsx)(I.eU,{children:(0,V.jsx)(V.Fragment,{children:(0,V.jsxs)(y.Z,{component:"form",onSubmit:function(e){J&&n(e)},pb:"10vh",sx:{"& .MuiTextField-root":{m:1,borderRadius:"10px",borderBlockColor:"colorWhite.main",backgroundColor:"colorWhite.main",boxShadow:" 0px 4px 4px gray inset"}},children:[(0,V.jsxs)($,{children:[(0,V.jsx)(w.Z,{noWrap:!0,variant:"body1",color:"primary.main",textAlign:"center",children:"Nom :"}),(0,V.jsx)(w.Z,{noWrap:!0,variant:"body1",color:"primary.main",textAlign:"center",children:"Pr\xe9nom :"})]}),(0,V.jsxs)(B,{children:[(0,V.jsx)(H,{children:(0,V.jsx)(w.Z,{noWrap:!0,variant:"body1",color:"primary.main",textAlign:"center",children:"Nom :"})}),(0,V.jsx)(I.Qq,{name:"nom",regex:[/[a-zA-Z]+/g,"Vous pouvez mettre des lettres latin"],after:function(e){return a(e)},children:(0,V.jsx)(b.Z,{required:!0,type:"text",placeholder:"Entrez votre nom...",sx:{width:{xs:"80vw",md:"22vw"},backgroundColor:"colorWhite.main"},name:"nom"})}),(0,V.jsx)(H,{children:(0,V.jsx)(w.Z,{noWrap:!0,variant:"body1",color:"primary.main",textAlign:"center",children:"Pr\xe9nom :"})}),(0,V.jsx)(I.Qq,{name:"prenom",regex:[/[a-zA-Z]+/g,"Vous pouvez mettre des lettres latin"],after:function(e){return c(e)},children:(0,V.jsx)(b.Z,{required:!0,type:"text",placeholder:"Entrez votre pr\xe9nom..",sx:{width:{xs:"80vw",md:"22vw"},backgroundColor:"colorWhite.main"},name:"prenom"})})]}),(0,V.jsx)("div",{children:" \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"}),(0,V.jsxs)($,{children:[(0,V.jsx)(w.Z,{variant:"body1",color:"primary.main",textAlign:"center",children:"Pseudo :"}),(0,V.jsx)(w.Z,{variant:"body1",color:"primary.main",textAlign:"center",children:"Role :"})]}),(0,V.jsxs)(B,{children:[(0,V.jsx)(H,{children:(0,V.jsx)(w.Z,{noWrap:!0,variant:"body1",color:"primary.main",textAlign:"center",children:"Pseudo :"})}),(0,V.jsx)(I.Qq,{name:"nickname",custom:[function(e){return e.length<=10&&e.length>0},"Maximum 10 ch"],after:function(e){return S(e)},children:(0,V.jsx)(b.Z,{required:!0,type:"text",placeholder:"Entrez votre pseudo...",sx:{width:{xs:"80vw",md:"22vw"},textAlign:"center",backgroundColor:"colorWhite.main"},name:"nickname"})}),(0,V.jsx)(H,{children:(0,V.jsx)(w.Z,{noWrap:!0,variant:"body1",color:"primary.main",textAlign:"center",children:"Role :"})}),(0,V.jsx)(b.Z,{id:"outlined-select-role",select:!0,label:"Select",name:"role",value:M||Q.v.VISITEUR,defaultValue:Q.v.VISITEUR,sx:{width:{xs:"80vw",md:"22vw"},textAlign:"center",backgroundColor:"colorWhite.main"},disabled:R!==Q.v.ADMINISTRATEUR,onChange:function(e){L(e.target.value)},children:null===q||void 0===q?void 0:q.map((function(e,n){return(0,V.jsx)(N.Z,{value:e.role,children:e.role},n)}))})]}),(0,V.jsx)(w.Z,{variant:"body1",color:"primary.main",textAlign:"center",children:"Email :"}),(0,V.jsx)(I.Qq,{name:"email",regex:[/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/,"Votre email n'est pas valide"],after:function(e){return v(e)},children:(0,V.jsx)(b.Z,{required:!0,type:"text",placeholder:"Entrez votre email...",sx:{width:{xs:"80vw",md:"50vw"},textAlign:"center",backgroundColor:"colorWhite.main"},name:"email"})}),(0,V.jsx)(w.Z,{variant:"body1",color:"primary.main",textAlign:"center",children:"Mot de passe :"}),(0,V.jsx)(I.Qq,{name:"password",custom:[function(e){return e.length>7},"Minimum 7 ch"],after:function(e){return E(e)},children:(0,V.jsx)(b.Z,{required:!0,type:"text",placeholder:"Entrez votre mot de passe...",sx:{width:{xs:"80vw",md:"50vw"},textAlign:"center",backgroundColor:"colorWhite.main"},name:"password"})}),(0,V.jsx)("div",{children:" \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"}),(0,V.jsx)(_,{type:"submit",disabled:!J||R!==Q.v.ADMINISTRATEUR,color:"primary",children:"Submit"})]})})})})},G=t(5303),K=(0,z.ZP)("div")(m||(m=(0,T.Z)(["\n  padding-top: 5vh;\n  text-align: center;\n  overflow: hidden;\n\n  @media (max-width: 750px) {\n    align-items: center;\n  }\n"]))),X=function(){var e=(0,G.Ds)().enqueueSnackbar,n=(0,g.useState)(),t=(0,h.Z)(n,2),r=t[0],i=t[1],a=Z(),o=a.request,s=a.setError,l=(0,g.useContext)(f.Z).globalLogInDispatch,c=(0,j.TH)().pathname.split("/"),d="login"===c[c.length-1],u="admin"===c[c.length-1];(0,g.useEffect)((function(){r&&"success"in r&&(e("L'utilisateur est connect\xe9 avec succ\xe8s",{variant:"success"}),l({authToken:r.user.auth_token,userId:r.user.user_id,nom:r.user.nom,prenom:r.user.prenom,nickname:r.user.nickname,email:r.user.email,id_role:r.user.id_role,role:r.user.role}))}),[r,l]);var m=function(){var e=(0,p.Z)((0,x.Z)().mark((function e(n){var t,r,a,l,c,u;return(0,x.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=new FormData(n.currentTarget),a=null===(t=r.get("role"))||void 0===t?void 0:t.toString().toUpperCase(),l=3,void 0!==a&&(l=Object.keys(Q.v).indexOf(a)+1),e.prev=5,c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.get("email"),password:r.get("password"),nom:r.get("nom"),prenom:r.get("prenom"),nickname:r.get("nickname"),id_role:r.get("role")?l:3})},u="".concat(d?"login":"register"),e.next=10,o(u,c,i);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),s(e.t0.message||e.t0);case 15:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(n){return e.apply(this,arguments)}}();return(0,V.jsxs)(K,{children:[(0,V.jsx)("h1",{children:d?"Log In":u?"Ajouteur l'utilisateur":"Sign Up"}),d?(0,V.jsx)(L,{onSubmit:m}):(0,V.jsx)(J,{onSubmit:m})]})}}}]);